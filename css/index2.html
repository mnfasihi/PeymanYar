<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B2BSteel | پلتفرم تخصصی قالب فلزی بتن و سوله</title>
    
    <!-- فونت و آیکون -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ========== متغیرهای رنگ ========== */
        :root {
            --primary: #004586;
            --primary-dark: #002f5c;
            --accent: #E6B800;
            --bg: #F7F7F7;
            --card-bg: #FFFFFF;
            --muted: #6b7280;
            --dark: #1E1E1E;
            --text-dark: #2A2A2A;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
        }

        * {
            font-family: 'Vazirmatn', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: var(--bg);
            color: var(--dark);
            line-height: 1.6;
            scroll-behavior: smooth;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            cursor: pointer;
            border: none;
            background: none;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .hidden {
            display: none !important;
        }

        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.8s ease forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ========== ناوبری ========== */
        .navbar {
            background: var(--card-bg);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            transition: all 0.3s;
        }

        .navbar:hover {
            box-shadow: 0 3px 10px rgba(0,0,0,0.15);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            background: var(--primary);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .logo-text h1 {
            font-size: 1.5rem;
            color: var(--primary);
            font-weight: 700;
            line-height: 1.2;
        }

        .logo-text .slogan {
            font-size: 0.8rem;
            color: var(--accent);
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        .nav-links {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-link {
            color: #4b5563;
            padding: 6px 12px;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 0.95rem;
            white-space: nowrap;
        }

        .nav-link:hover {
            background: #f3f4f6;
            color: var(--primary);
        }

        /* ========== دکمه‌ها ========== */
        .btn {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
            font-size: 0.95rem;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--muted);
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
            transform: translateY(-2px);
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.85rem;
        }

        /* ========== صفحه اصلی - هیرو ========== */
        .hero {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: white;
            padding: 4rem 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 20%, rgba(230,184,0,0.15), transparent 70%),
                        radial-gradient(circle at 80% 80%, rgba(0,69,134,0.2), transparent 70%);
            z-index: 0;
        }

        .hero .container {
            position: relative;
            z-index: 1;
        }

        .hero h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            opacity: 0.95;
        }

        .hero-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* ========== شمارنده‌ها ========== */
        .counters {
            background: white;
            padding: 3rem 0;
            margin: 2rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .counters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .counter-item {
            text-align: center;
            padding: 1.5rem;
        }

        .counter-number {
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .counter-label {
            font-size: 1.2rem;
            color: #4b5563;
        }

        /* ========== اسلایدشو ========== */
        .image-slider {
            width: 100%;
            height: 450px;
            position: relative;
            overflow: hidden;
            margin: 2rem 0;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .slider-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .slider-image.active {
            opacity: 1;
        }

        /* ========== کارت‌های ویژگی‌ها ========== */
        .features {
            padding: 4rem 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            color: var(--primary);
            font-size: 2rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .feature-card {
            background: var(--card-bg);
            border-radius: 14px;
            padding: 2rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.06);
            transition: all 0.35s;
            height: 100%;
        }

        .feature-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.1);
        }

        .feature-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.7rem;
            margin-bottom: 1rem;
        }

        .feature-card h3 {
            margin-bottom: 1rem;
            color: var(--primary);
        }

        /* ========== فرم‌های احراز هویت ========== */
        .auth-container {
            max-width: 500px;
            margin: 2rem auto;
            padding: 2rem;
        }

        .auth-card {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .auth-title {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--primary);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #4b5563;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
            transition: border 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-help {
            font-size: 0.85rem;
            color: var(--muted);
            margin-top: 0.25rem;
        }

        .user-type-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .user-type-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            background: white;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .user-type-btn.active {
            border-color: var(--primary);
            background: #eff6ff;
            color: var(--primary);
        }

        /* ========== مودال ========== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 10px;
            width: 90%;
            max-width: 700px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            color: var(--primary);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--muted);
            cursor: pointer;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* ========== داشبورد ========== */
        .dashboard {
            padding: 2rem 0;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stat-card h3 {
            color: var(--muted);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .stat-card .value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        /* ========== فوتر ========== */
        .footer {
            background: var(--primary-dark);
            color: #ddd;
            padding: 4rem 0;
            margin-top: 4rem;
        }

        .footer h3 {
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .footer a {
            color: #ccc;
            transition: color 0.2s;
        }

        .footer a:hover {
            color: var(--accent);
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid #374151;
            color: #9ca3af;
        }

        /* ========== ریسپانسیو ========== */
        @media (max-width: 992px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            .nav-links {
                justify-content: center;
            }
        }
        @media (max-width: 768px) {
            .hero h2 {
                font-size: 2rem;
            }
            .hero p {
                font-size: 1rem;
            }
            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
            .image-slider {
                height: 300px;
            }
            .counter-number {
                font-size: 2rem;
            }
            .date-selector {
                flex-direction: column;
            }
            .dashboard-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
<!-- ========== ناوبری اصلی ========== -->
<nav class="navbar">
    <div class="container nav-container">
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-cubes"></i>
            </div>
            <div class="logo-text">
                <h1>B2BSteel</h1>
                <div class="slogan">اعتماد - شفافیت - سرعت</div>
            </div>
        </div>
        
        <div class="nav-links">
            <a href="#" class="nav-link" onclick="window.showPage('home')">خانه</a>
            <a href="#" class="nav-link" onclick="window.showPage('concrete-formwork')">قالب بتن</a>
            <a href="#" class="nav-link" onclick="window.showPage('shed')">سوله</a>
            <a href="#" class="nav-link" onclick="window.showPage('blog')">بلاگ</a>
            <a href="#" class="nav-link" onclick="window.showPage('terms')">قوانین</a>
            <a href="#" class="nav-link" onclick="window.showPage('guide')">راهنما</a>
            
            <div id="auth-buttons">
                <button class="btn btn-primary btn-sm" onclick="window.showPage('login')">ورود</button>
                <button class="btn btn-secondary btn-sm" onclick="window.showPage('register')">ثبت‌نام</button>
            </div>
            
            <div id="user-menu" class="hidden">
                <button class="btn btn-primary btn-sm" onclick="window.showPage('dashboard')">داشبورد</button>
                <button class="btn btn-danger btn-sm" onclick="window.logout()">خروج</button>
            </div>
            
            <div id="seller-formwork-menu" class="hidden">
                <button class="btn btn-primary btn-sm" onclick="window.showPage('seller-formwork-dashboard')">داشبورد فروشنده قالب</button>
                <button class="btn btn-danger btn-sm" onclick="window.logout()">خروج</button>
            </div>
            
            <div id="seller-shed-menu" class="hidden">
                <button class="btn btn-success btn-sm" onclick="window.showPage('seller-shed-dashboard')">داشبورد فروشنده سوله</button>
                <button class="btn btn-danger btn-sm" onclick="window.logout()">خروج</button>
            </div>
            
            <div id="admin-menu" class="hidden">
                <button class="btn btn-warning btn-sm" onclick="window.showPage('admin')">پنل ادمین</button>
                <button class="btn btn-primary btn-sm" onclick="window.showPage('dashboard')">داشبورد</button>
                <button class="btn btn-danger btn-sm" onclick="window.logout()">خروج</button>
            </div>
        </div>
    </div>
</nav>

<!-- ========== صفحات اصلی ========== -->
<main id="pages">

    <!-- صفحه اصلی -->
    <section id="home-page" class="page">
        <div class="hero fade-in">
            <div class="container">
                <h2>پلتفرم B2BSteel</h2>
                <p>اولین پلتفرم تخصصی ارتباط خریداران و فروشندگان سوله و قالب فلزی بتن</p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" style="padding: 12px 25px;" onclick="window.showPage('register')">
                        <i class="fas fa-user-tie"></i> ثبت‌نام خریدار
                    </button>
                    <button class="btn btn-success" style="padding: 12px 25px;" onclick="window.showPage('register')">
                        <i class="fas fa-industry"></i> ثبت‌نام فروشنده
                    </button>
                </div>
            </div>
        </div>

        <!-- شمارنده‌ها -->
        <div class="counters">
            <div class="container">
                <div class="counters-grid">
                    <div class="counter-item">
                        <div class="counter-number" id="counter-sellers">۰</div>
                        <div class="counter-label">فروشنده ثبت‌نام شده</div>
                    </div>
                    <div class="counter-item">
                        <div class="counter-number" id="counter-buyers">۰</div>
                        <div class="counter-label">خریدار ثبت‌نام شده</div>
                    </div>
                    <div class="counter-item">
                        <div class="counter-number" id="counter-transactions">۰</div>
                        <div class="counter-label">فروش نهایی شده</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- اسلایدشو -->
        <div class="container">
            <div class="image-slider">
                <img src="https://img.edilportale.com/product-thumbs/b_P300-Pilosio-611087-rel51b5c439.jpg" alt="قالب فلزی بتن" class="slider-image active">
                <img src="https://img.edilportale.com/product-thumbs/b_P300-Pilosio-611087-rel991e93b7.jpg" alt="قالب فلزی بتن" class="slider-image">
                <div class="slider-image" style="background: linear-gradient(135deg, var(--primary-dark), var(--primary)); display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                    <div style="text-align: center;">
                        <i class="fas fa-industry" style="font-size: 4rem; margin-bottom: 1rem;"></i>
                        <p>صنعت ساختمان</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- ویژگی‌ها -->
        <div class="features">
            <div class="container">
                <h2 class="section-title">چرا B2BSteel؟</h2>
                <div class="features-grid">
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                        <h3>حریم خصوصی کاملاً محفوظ</h3>
                        <p>اطلاعات هویتی فروشندگان تا زمان انتخاب نهایی مخفی می‌ماند. خریداران می‌توانند با خیال راحت پیشنهادها را مقایسه کنند.</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>شفافیت کامل قیمت</h3>
                        <p>خریدار می‌تواند تمام پیشنهادات قیمت را به صورت شفاف مشاهده و مقایسه کند. سیستم قیمت‌گذاری دقیق و شفاف.</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-handshake"></i>
                        </div>
                        <h3>ارتباط مستقیم و سریع</h3>
                        <p>ایجاد ارتباط مستقیم بین خریداران و فروشندگان معتبر بدون واسطه. کاهش زمان مذاکرات و معاملات.</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3>تایید هویت اعضا</h3>
                        <p>تمام اعضا پس از بررسی مدارک تایید می‌شوند. سیستم امتیازدهی و نظرات برای افزایش اعتماد.</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <h3>گارانتی و تضمین کیفیت</h3>
                        <p>تمام فروشندگان متعهد به ارائه گارانتی محصولات هستند. سیستم امتیازدهی کیفیت را تضمین می‌کند.</p>
                    </div>
                    <div class="feature-card fade-in">
                        <div class="feature-icon">
                            <i class="fas fa-headset"></i>
                        </div>
                        <h3>پشتیبانی ۲۴ ساعته</h3>
                        <p>تیم پشتیبانی ما به صورت ۲۴ ساعته آماده پاسخگویی به سوالات و حل مشکلات شماست.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه قالب بتن -->
    <section id="concrete-formwork-page" class="page hidden">
        <div class="hero fade-in">
            <div class="container">
                <h2>بخش قالب فلزی بتن</h2>
                <p>خرید و فروش تخصصی انواع قالب فلزی بتن</p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" style="padding: 12px 25px;" onclick="window.showPage('register')">
                        <i class="fas fa-user-tie"></i> من خریدار هستم
                    </button>
                    <button class="btn btn-success" style="padding: 12px 25px;" onclick="window.showPage('register')">
                        <i class="fas fa-industry"></i> من فروشنده هستم
                    </button>
                </div>
            </div>
        </div>
        
        <div class="container" style="padding: 4rem 0;">
            <div class="features-grid">
                <div class="feature-card fade-in">
                    <div class="feature-icon">
                        <i class="fas fa-cube"></i>
                    </div>
                    <h3>قالب مدولار</h3>
                    <p>قالب‌بندی سریع و با کیفیت برای پروژه‌های مختلف ساختمانی</p>
                </div>
                <div class="feature-card fade-in">
                    <div class="feature-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <h3>قالب دیوار و ستون</h3>
                    <p>قالب‌های مخصوص دیوار و ستون با مقاومت بالا و دوام طولانی</p>
                </div>
                <div class="feature-card fade-in">
                    <div class="feature-icon">
                        <i class="fas fa-bridge"></i>
                    </div>
                    <h3>قالب تونل و پل</h3>
                    <p>قالب‌های تخصصی برای پروژه‌های بزرگ عمرانی</p>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 3rem;">
                <button class="btn btn-primary" style="padding: 15px 40px; font-size: 1.2rem;" onclick="window.enterConcreteFormworkSystem()">
                    <i class="fas fa-sign-in-alt"></i> ورود به سیستم قالب بتن
                </button>
            </div>
        </div>
    </section>

    <!-- صفحه سوله -->
    <section id="shed-page" class="page hidden">
        <div class="container shed-page-container">
            <h2 class="section-title">بخش سوله</h2>
            <p style="color: var(--muted); text-align: center; max-width: 800px; margin: 0 auto 2rem;">
                انتخاب خدمات مورد نیاز خود در حوزه سوله
            </p>
            
            <div class="shed-options" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem; margin: 3rem 0;">
                <div class="shed-option-card" style="background: white; border-radius: 10px; padding: 2.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center; transition: all 0.3s;">
                    <div style="width: 70px; height: 70px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 1.8rem; color: white;">
                        <i class="fas fa-plus-circle"></i>
                    </div>
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">سوله نو</h3>
                    <button class="btn btn-primary" onclick="window.showPage('new-shed-request')" style="width: 100%;">
                        <i class="fas fa-file-alt"></i> پر کردن پرسشنامه سوله نو
                    </button>
                </div>
                
                <div class="shed-option-card" style="background: white; border-radius: 10px; padding: 2.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                    <div style="width: 70px; height: 70px; background: var(--success); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; font-size: 1.8rem; color: white;">
                        <i class="fas fa-warehouse"></i>
                    </div>
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">سوله دست دوم</h3>
                    <button class="btn btn-success" onclick="window.loadSecondhandSheds()" style="width: 100%;">
                        <i class="fas fa-search"></i> مشاهده آگهی‌ها
                    </button>
                </div>
            </div>
        </div>
    </section>
    
    <!-- صفحه درخواست سوله نو -->
    <section id="new-shed-request-page" class="page hidden">
        <div class="container">
            <div style="max-width: 800px; margin: 0 auto; padding: 2rem 0;">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <h1 style="color: var(--primary); margin-bottom: 0.5rem;">پرسشنامه درخواست سوله نو</h1>
                    <p style="color: var(--muted);">لطفاً اطلاعات پروژه خود را با دقت وارد کنید</p>
                </div>
                
                <form id="new-shed-form">
                    <!-- ابعاد سوله -->
                    <div style="background: white; border-radius: 10px; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-ruler-combined" style="color: var(--primary);"></i> ابعاد سوله
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div class="form-group">
                                <label for="shed-length">طول سوله (متر)</label>
                                <input type="number" id="shed-length" class="form-control" required min="10" step="0.5" placeholder="مثال: 100">
                            </div>
                            <div class="form-group">
                                <label for="shed-width">عرض سوله (متر)</label>
                                <input type="number" id="shed-width" class="form-control" required min="10" step="0.5" placeholder="مثال: 30">
                            </div>
                            <div class="form-group">
                                <label for="shed-height">ارتفاع کنار سوله (متر)</label>
                                <input type="number" id="shed-height" class="form-control" required min="4" step="0.5" placeholder="مثال: 6">
                            </div>
                        </div>
                    </div>
                    
                    <!-- نقشه سازه -->
                    <div style="background: white; border-radius: 10px; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-drafting-compass"></i> نقشه سازه
                        </h3>
                        <div class="form-group">
                            <label>آیا فایل نقشه سازه دارید؟</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 1.5rem;">
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="has-drawing" value="yes" onclick="window.toggleDrawingUpload(true)"> بله، دارم
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="has-drawing" value="no" checked onclick="window.toggleDrawingUpload(false)"> خیر، نیاز به طراحی دارم
                                </label>
                            </div>
                        </div>
                        
                        <div id="drawing-upload-section" class="hidden">
                            <div class="form-group">
                                <label for="shed-drawing">آپلود فایل نقشه (اختیاری)</label>
                                <input type="file" id="shed-drawing" class="form-control" accept=".pdf,.dwg,.jpg,.jpeg,.png">
                                <small style="color: var(--muted); display: block; margin-top: 5px;">فرمت‌های مجاز: PDF, DWG, JPG, PNG</small>
                            </div>
                        </div>
                    </div>
                    
                    <!-- اطلاعات پروژه -->
                    <div style="background: white; border-radius: 10px; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-info-circle"></i> اطلاعات پروژه
                        </h3>
                        <div class="form-group">
                            <label for="shed-usage">کارکرد سوله</label>
                            <textarea id="shed-usage" class="form-control" rows="3" required placeholder="برای چه منظوری نیاز به سوله دارید؟"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="shed-location">محل نصب سوله</label>
                            <input type="text" id="shed-location" class="form-control" required placeholder="استان، شهر، آدرس دقیق">
                        </div>
                    </div>
                    
                    <!-- جرثقیل سقفی -->
                    <div style="background: white; border-radius: 10px; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-crane"></i> جرثقیل سقفی
                        </h3>
                        <div class="form-group">
                            <label>آیا به جرثقیل سقفی نیاز دارید؟</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 1.5rem;">
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="needs-crane" value="yes" onclick="window.toggleCraneDetails(true)"> بله، نیاز دارم
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="needs-crane" value="no" checked onclick="window.toggleCraneDetails(false)"> خیر، نیازی نیست
                                </label>
                            </div>
                        </div>
                        
                        <div id="crane-details-section" class="hidden">
                            <div class="form-group">
                                <label for="crane-tonnage">تناژ جرثقیل سقفی (تن)</label>
                                <input type="number" id="crane-tonnage" class="form-control" min="1" max="100" step="0.5" placeholder="مثال: 5">
                            </div>
                        </div>
                    </div>
                    
                    <!-- فونداسیون -->
                    <div style="background: white; border-radius: 10px; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-layer-group"></i> فونداسیون
                        </h3>
                        <div class="form-group">
                            <label>آیا فونداسیون آماده است؟</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 1.5rem;">
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="foundation" value="yes"> بله، آماده است
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="foundation" value="no" checked> خیر، نیاز به اجرا دارم
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- سندبلاست و رنگ -->
                    <div style="background: white; border-radius: 10px; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-paint-roller"></i> سندبلاست و رنگ
                        </h3>
                        <div class="form-group">
                            <label>آیا به سندبلاست نیاز دارید؟</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 1.5rem;">
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="sandblast" value="yes"> بله
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="sandblast" value="no" checked> خیر
                                </label>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="paint-type">نوع رنگ مورد نیاز</label>
                            <select id="paint-type" class="form-control" onchange="window.toggleOtherPaintType()">
                                <option value="">انتخاب کنید</option>
                                <option value="ضد زنگ">ضد زنگ</option>
                                <option value="آلکیدی">آلکیدی</option>
                                <option value="زینک ریچ">زینک ریچ</option>
                                <option value="اپوکسی">اپوکسی</option>
                                <option value="other">سایر</option>
                            </select>
                            <input type="text" id="other-paint-type" class="form-control hidden" placeholder="نوع رنگ را وارد کنید" style="margin-top: 10px;">
                        </div>
                        
                        <div class="form-group">
                            <label for="paint-thickness">ضخامت رنگ (میکرون)</label>
                            <input type="number" id="paint-thickness" class="form-control" value="50" min="20" max="200" step="5">
                        </div>
                    </div>
                    
                    <!-- مسئولیت‌های خریدار -->
                    <div style="background: white; border-radius: 10px; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-tasks"></i> مسئولیت‌های خریدار
                        </h3>
                        <div style="display: flex; flex-wrap: wrap; gap: 1.5rem;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="responsibility" value="steel"> تهیه آهن آلات
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="responsibility" value="bolts"> تهیه پیچ و مهره
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="responsibility" value="transport"> حمل
                            </label>
                        </div>
                    </div>
                    
                    <!-- وزن و قیمت -->
                    <div style="background: white; border-radius: 10px; padding: 2rem; margin-bottom: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-balance-scale"></i> وزن و قیمت
                        </h3>
                        <div class="form-group">
                            <label for="shed-weight">وزن سوله (تن) - در صورت اطلاع</label>
                            <input type="number" id="shed-weight" class="form-control" min="1" step="0.1" placeholder="وزن تقریبی">
                        </div>
                        <div class="form-group">
                            <label>نوع قیمت‌گذاری</label>
                            <div style="display: flex; flex-wrap: wrap; gap: 1.5rem;">
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="price-type" value="estimated" checked> قیمت حدودی
                                </label>
                                <label style="display: flex; align-items: center; gap: 8px;">
                                    <input type="radio" name="price-type" value="exact"> قیمت دقیق
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem;">
                        <button type="button" class="btn btn-secondary" onclick="window.showPage('shed')">
                            <i class="fas fa-arrow-right"></i> بازگشت
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> ارسال درخواست
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- صفحه قوانین و شرایط -->
    <section id="terms-page" class="page hidden">
        <div class="container" style="max-width: 900px; margin: 0 auto; padding: 3rem 0;">
            <div style="background: white; border-radius: 10px; padding: 2.5rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                <h1 class="section-title" style="margin-bottom: 2rem;">قوانین و شرایط استفاده از B2BSteel</h1>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۱. مقدمه و کلیات</h3>
                    <p>پلتفرم B2BSteel یک بازارگاه آنلاین (Marketplace) برای ارتباط مستقیم بین خریداران و فروشندگان محصولات مرتبط با قالب‌های فلزی بتن و سازه‌های فولادی (سوله) است. این پلتفرم صرفاً به عنوان یک واسط فناوری‌محور عمل کرده و نقش آن محدود به نمایش درخواست‌ها و پیشنهادات است. هرگونه توافق نهایی، عقد قرارداد، مبادله کالا، پرداخت وجه و انجام تعهدات، مستقیماً و با مسئولیت کامل خریدار و فروشنده صورت می‌پذیرد. استفاده از این پلتفرم به معنای مطالعه و پذیرش کامل کلیه شرایط و قوانین زیر است.</p>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۲. مسئولیت پلتفرم</h3>
                    <p><strong>عدم مسئولیت در قبال معاملات:</strong> پلتفرم B2BSteel هیچ‌گونه مسئولیتی در قبال کیفیت کالاها، تحویل به موقع، تطابق کالا با مشخصات درخواستی، و یا انجام تعهدات مالی خریداران و فروشندگان ندارد. قرارداد نهایی فی‌مابین خریدار و فروشنده منعقد می‌شود و پلتفرم طرف هیچ‌یک از معاملات نیست.</p>
                    <p><strong>عدم مسئولیت در قبال خسارات:</strong> پلتفرم مسئولیتی در قبال هرگونه خسارت مستقیم، غیرمستقیم، اتفاقی یا تبعی ناشی از استفاده از سایت یا عدم انجام تعهدات توسط طرفین معامله ندارد.</p>
                    <p><strong>صحت اطلاعات:</strong> پلتفرم محتوای درج شده توسط کاربران (از جمله مشخصات فنی، قیمت‌ها و تصاویر) را تأیید یا تضمین نمی‌کند. کاربران موظف به تحقیق و بررسی دقیق قبل از هرگونه همکاری هستند.</p>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۳. مسئولیت‌های کاربران (خریداران و فروشندگان)</h3>
                    <p><strong>احراز هویت و اطلاعات:</strong> کاربران متعهد هستند اطلاعات صحیح، کامل و به‌روز خود (اعم از حقیقی یا حقوقی) را در فرآیند ثبت‌نام وارد نمایند. پلتفرم این حق را برای خود محفوظ می‌دارد که در صورت مشاهده هرگونه اطلاعات نادرست یا سوءاستفاده، حساب کاربری را مسدود نماید.</p>
                    <p><strong>رعایت قوانین:</strong> کاربران موظف به رعایت کلیه قوانین جاری کشور جمهوری اسلامی ایران، از جمله قوانین مالیاتی، تجارت الکترونیک و مقررات صنفی مرتبط با فعالیت خود هستند.</p>
                    <p><strong>پیشنهادات و درخواست‌ها:</strong> فروشندگان تنها مجاز به ارسال پیشنهاد برای درخواست‌هایی هستند که توانایی و تخصص اجرای آن‌ها را دارند. خریداران نیز باید درخواست‌های خود را با نهایت دقت و شفافیت ثبت نمایند.</p>
                    <p><strong>امتیازدهی و نظرات:</strong> پس از انجام معامله، خریداران می‌توانند فروشنده را بر اساس معیارهایی مانند کیفیت، تحویل به‌موقع و ارتباطات امتیازدهی کرده و نظر خود را ثبت کنند. این امتیازات به سایر خریداران در انتخاب فروشنده مناسب کمک خواهد کرد.</p>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۴. قوانین مالی و پرداخت</h3>
                    <p>تمامی تراکنش‌های مالی (اعم از پیش‌پرداخت، بیعانه یا تسویه نهایی) به طور مستقیم و خارج از بستر پلتفرم بین خریدار و فروشنده انجام می‌شود. پلتفرم B2BSteel در حال حاضر هیچ درگاه پرداختی را واسط‌گری نمی‌کند و مسئولیتی در قبال وجوه رد و بدل شده ندارد.</p>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۵. محرمانگی و حریم خصوصی</h3>
                    <p>اطلاعات هویتی و تماس فروشندگان تا زمان انتخاب نهایی توسط خریدار، برای سایر کاربران مخفی می‌ماند. این ویژگی به منظور حفظ حریم خصوصی و جلوگیری از معاملات خارج از پلتفرم طراحی شده است. پلتفرم متعهد می‌شود از اطلاعات شخصی کاربران (نظیر شماره تماس، ایمیل و آدرس) صرفاً در راستای بهبود خدمات استفاده کرده و از افشای آن به اشخاص ثالث خودداری نماید، مگر در مواردی که الزام قانونی وجود داشته باشد.</p>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۶. حق مسدود کردن حساب</h3>
                    <p>پلتفرم B2BSteel این حق را دارد که در صورت مشاهده هرگونه تخلف از قوانین سایت، ارائه اطلاعات نادرست، یا هرگونه اقدامی که به اعتبار پلتفرم لطمه بزند (مانند تبانی برای دور زدن سیستم)، بدون هیچ‌گونه اخطار قبلی، حساب کاربری فرد خاطی را مسدود کرده و دسترسی او را از پلتفرم قطع نماید.</p>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۷. مالکیت فکری</h3>
                    <p>کلیه محتوای سایت شامل کدها، طراحی گرافیکی، لوگو و متون، متعلق به پلتفرم B2BSteel بوده و هرگونه کپی‌برداری یا استفاده تجاری بدون مجوز کتبی، پیگرد قانونی دارد.</p>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۸. قوانین بازاریابی و ارتباطات</h3>
                    <p>فروشندگان مجاز به ارسال پیام‌های تبلیغاتی مستقیم (اسپم) به خریداران نیستند. ارتباطات باید صرفاً در چارچوب درخواست‌های ثبت شده و با هدف انجام معامله صورت پذیرد.</p>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۹. تغییرات در قوانین</h3>
                    <p>پلتفرم B2BSteel این حق را برای خود محفوظ می‌دارد که در هر زمان و بدون نیاز به اطلاع‌رسانی قبلی، نسبت به تغییر یا به‌روزرسانی این شرایط اقدام نماید. ادامه استفاده از سایت پس از تغییرات، به معنای پذیرش قوانین جدید خواهد بود.</p>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">۱۰. حل اختلاف</h3>
                    <p>در صورت بروز هرگونه اختلاف میان کاربران، طرفین موظفند ابتدا از طریق مذاکره مستقیم مسئله را حل و فصل نمایند. در صورت عدم حصول نتیجه، اختلاف از طریق مراجع قضایی صالح قابل پیگیری خواهد بود.</p>
                </div>
                
                <div style="background: #f8fafc; border-radius: 8px; padding: 1.5rem; margin-top: 2rem; text-align: center;">
                    <p>آخرین به‌روزرسانی: بهمن ۱۴۰۴</p>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه راهنما -->
    <section id="guide-page" class="page hidden">
        <div class="container" style="padding: 4rem 0;">
            <h2 class="section-title">راهنمای استفاده از B2BSteel</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                <div style="background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                    <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: white; font-weight: bold; font-size: 1.5rem;">۱</div>
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">ثبت‌نام</h3>
                    <p>به عنوان خریدار یا فروشنده ثبت‌نام کنید و اطلاعات خود را تکمیل نمایید.</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                    <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: white; font-weight: bold; font-size: 1.5rem;">۲</div>
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">ایجاد درخواست</h3>
                    <p>خریداران درخواست خود را با جزئیات کامل ثبت می‌کنند.</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                    <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: white; font-weight: bold; font-size: 1.5rem;">۳</div>
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">دریافت پیشنهاد</h3>
                    <p>فروشندگان معتبر پیشنهادات خود را ارسال می‌کنند.</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                    <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: white; font-weight: bold; font-size: 1.5rem;">۴</div>
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">انتخاب و ارتباط</h3>
                    <p>خریدار بهترین پیشنهاد را انتخاب کرده و اطلاعات فروشنده را دریافت می‌کند.</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                    <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: white; font-weight: bold; font-size: 1.5rem;">۵</div>
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">انجام معامله</h3>
                    <p>طرفین قرارداد خود را منعقد کرده و فرآیند اجرا آغاز می‌شود.</p>
                </div>
                <div style="background: white; border-radius: 10px; padding: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                    <div style="width: 50px; height: 50px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; color: white; font-weight: bold; font-size: 1.5rem;">۶</div>
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">ثبت نظر و امتیاز</h3>
                    <p>پس از اتمام کار، خریدار می‌تواند نظر و امتیاز خود را ثبت کند.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه بلاگ -->
    <section id="blog-page" class="page hidden">
        <div class="container" style="padding: 4rem 0;">
            <h2 class="section-title">مقالات و اخبار</h2>
            <div class="blog-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                <div class="blog-card" style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                    <div style="width: 100%; height: 250px; background: linear-gradient(135deg, var(--primary-dark), var(--primary)); display: flex; align-items: center; justify-content: center; color: white;">
                        <i class="fas fa-cubes" style="font-size: 4rem;"></i>
                    </div>
                    <div class="blog-content" style="padding: 1.5rem;">
                        <h3 class="blog-title" style="color: var(--primary); margin-bottom: 0.5rem;">انواع قالب فلزی بتن و کاربردهای آنها</h3>
                        <div class="blog-date" style="color: var(--muted); margin-bottom: 1rem;">۱۴۰۲/۱۲/۱۵</div>
                        <p class="blog-excerpt" style="color: #4b5563;">قالب فلزی بتن به عنوان یکی از پرکاربردترین سیستم‌های قالب‌بندی در صنعت ساختمان شناخته می‌شود...</p>
                        <a href="#" class="read-more" style="color: var(--primary); font-weight: 600; display: inline-block; margin-top: 1rem;">ادامه مطلب</a>
                    </div>
                </div>
                <div class="blog-card">
                    <div style="width: 100%; height: 250px; background: linear-gradient(135deg, #047857, #10b981); display: flex; align-items: center; justify-content: center; color: white;">
                        <i class="fas fa-building" style="font-size: 4rem;"></i>
                    </div>
                    <div class="blog-content">
                        <h3 class="blog-title">نکات کلیدی در انتخاب قالب مناسب</h3>
                        <div class="blog-date">۱۴۰۲/۱۲/۱۰</div>
                        <p class="blog-excerpt">انتخاب قالب مناسب می‌تواند تأثیر زیادی در کیفیت نهایی، سرعت اجرا و هزینه‌های پروژه داشته باشد...</p>
                        <a href="#" class="read-more">ادامه مطلب</a>
                    </div>
                </div>
                <div class="blog-card">
                    <div style="width: 100%; height: 250px; background: linear-gradient(135deg, #7c3aed, #a855f7); display: flex; align-items: center; justify-content: center; color: white;">
                        <i class="fas fa-industry" style="font-size: 4rem;"></i>
                    </div>
                    <div class="blog-content">
                        <h3 class="blog-title">مزایای قالب مدولار در ساخت‌وساز</h3>
                        <div class="blog-date">۱۴۰۲/۱۲/۰۵</div>
                        <p class="blog-excerpt">قالب مدولار به دلیل انعطاف‌پذیری و سرعت نصب بالا، تبدیل به یکی از محبوب‌ترین سیستم‌های قالب‌بندی شده است...</p>
                        <a href="#" class="read-more">ادامه مطلب</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه ثبت‌نام -->
    <section id="register-page" class="page hidden">
        <div class="auth-container">
            <div class="auth-card">
                <h2 class="auth-title">ثبت‌نام در B2BSteel</h2>
                
                <div class="user-type-selector" id="user-type-main-selector">
                    <div class="user-type-btn active" data-type="buyer" onclick="window.selectUserType('buyer')">
                        <i class="fas fa-user-tie"></i> خریدار
                    </div>
                    <div class="user-type-btn" data-type="seller" onclick="window.selectUserType('seller')">
                        <i class="fas fa-industry"></i> فروشنده
                    </div>
                </div>
                
                <div class="form-group">
                    <label>نوع کاربر</label>
                    <div class="user-type-selector" id="user-legal-type-selector">
                        <div class="user-type-btn" data-type="individual" onclick="window.selectUserLegalType('individual')">
                            <i class="fas fa-user"></i> شخص حقیقی
                        </div>
                        <div class="user-type-btn active" data-type="company" onclick="window.selectUserLegalType('company')">
                            <i class="fas fa-building"></i> شرکت/حقوقی
                        </div>
                    </div>
                </div>
                
                <div id="seller-type-section" class="form-group hidden">
                    <label>نوع فروشنده</label>
                    <div class="user-type-selector" id="seller-type-selector">
                        <div class="user-type-btn active" data-type="formwork" onclick="window.selectSellerType('formwork')">
                            <i class="fas fa-cubes"></i> فروشنده قالب
                        </div>
                        <div class="user-type-btn" data-type="shed" onclick="window.selectSellerType('shed')">
                            <i class="fas fa-warehouse"></i> فروشنده سوله
                        </div>
                    </div>
                </div>
                
                <form id="register-form">
                    <div class="form-group">
                        <label for="reg-email">ایمیل</label>
                        <input type="email" id="reg-email" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="reg-password">رمز عبور</label>
                        <input type="password" id="reg-password" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="reg-password-confirm">تکرار رمز عبور</label>
                        <input type="password" id="reg-password-confirm" class="form-control" required>
                        <div id="password-match-error" style="color: red; font-size: 0.85rem; margin-top: 5px;"></div>
                    </div>
                    
                    <div id="company-fields">
                        <div class="form-group">
                            <label for="reg-company" id="company-label">نام شرکت</label>
                            <input type="text" id="reg-company" class="form-control" placeholder="مثال: شرکت ساختمانی پیشرو">
                        </div>
                        <div class="form-group">
                            <label for="reg-position">سمت سازمانی (اختیاری)</label>
                            <input type="text" id="reg-position" class="form-control" placeholder="مثال: مدیر بازرگانی">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="reg-contact">نام شخص رابط</label>
                        <input type="text" id="reg-contact" class="form-control" required placeholder="نام و نام خانوادگی">
                    </div>
                    
                    <div class="form-group">
                        <label for="reg-phone">تلفن تماس</label>
                        <input type="tel" id="reg-phone" class="form-control" required placeholder="۰۹۱۲۱۲۳۴۵۶۷">
                    </div>
                    
                    <!-- چک‌باکس پذیرش قوانین -->
                    <div class="form-group">
                        <label style="display: flex; align-items: flex-start; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="accept-terms" required style="margin-top: 3px; width: 18px; height: 18px;">
                            <span>
                                <a href="#" onclick="window.showPage('terms'); return false;" style="color: var(--primary); text-decoration: underline;">قوانین و شرایط</a> پلتفرم B2BSteel را مطالعه کرده‌ام و می‌پذیرم.
                            </span>
                        </label>
                    </div>
                    
                    <div id="register-error" style="color: red; margin-bottom: 1rem;"></div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px;">ثبت‌نام</button>
                </form>
                
                <p style="text-align: center; margin-top: 1rem;">
                    قبلاً حساب دارید؟ <a href="#" onclick="window.showPage('login')" style="color: var(--primary);">وارد شوید</a>
                </p>
            </div>
        </div>
    </section>

    <!-- صفحه ورود -->
    <section id="login-page" class="page hidden">
        <div class="auth-container">
            <div class="auth-card">
                <h2 class="auth-title">ورود به حساب کاربری</h2>
                
                <form id="login-form">
                    <div class="form-group">
                        <label for="login-email">ایمیل</label>
                        <input type="email" id="login-email" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="login-password">رمز عبور</label>
                        <input type="password" id="login-password" class="form-control" required>
                    </div>
                    
                    <div class="form-group" style="text-align: left;">
                        <a href="#" onclick="window.showPage('forgot-password')" style="color: var(--primary); font-size: 0.9rem;">رمز عبور را فراموش کرده‌اید؟</a>
                    </div>
                    
                    <div id="login-error" style="color: red; margin-bottom: 1rem;"></div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px;">ورود</button>
                </form>
                
                <p style="text-align: center; margin-top: 1rem;">
                    حساب ندارید؟ <a href="#" onclick="window.showPage('register')" style="color: var(--primary);">ثبت‌نام کنید</a>
                </p>
            </div>
        </div>
    </section>

    <!-- صفحه فراموشی رمز عبور (جدید) -->
    <section id="forgot-password-page" class="page hidden">
        <div class="auth-container">
            <div class="auth-card">
                <h2 class="auth-title">بازیابی رمز عبور</h2>
                
                <form id="forgot-password-form">
                    <div class="form-group">
                        <label for="reset-email">ایمیل خود را وارد کنید</label>
                        <input type="email" id="reset-email" class="form-control" required placeholder="example@email.com">
                        <small style="color: var(--muted); display: block; margin-top: 5px;">لینک بازیابی رمز عبور به این ایمیل ارسال خواهد شد.</small>
                    </div>
                    
                    <div id="reset-message" style="color: green; margin-bottom: 1rem; text-align: center;"></div>
                    <div id="reset-error" style="color: red; margin-bottom: 1rem; text-align: center;"></div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px;">ارسال لینک بازیابی</button>
                </form>
                
                <p style="text-align: center; margin-top: 1rem;">
                    <a href="#" onclick="window.showPage('login')" style="color: var(--primary);">بازگشت به صفحه ورود</a>
                </p>
            </div>
        </div>
    </section>

    <!-- صفحه داشبورد خریدار -->
    <section id="dashboard-page" class="page hidden">
        <div class="container dashboard">
            <div class="dashboard-header">
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">?</div>
                    <div>
                        <h2 id="user-name">کاربر عزیز</h2>
                        <p id="user-type">نوع حساب: در حال بارگذاری...</p>
                    </div>
                </div>
                <div id="buyer-actions">
                    <button class="btn btn-primary" onclick="window.showNewRequestModal()">
                        <i class="fas fa-plus"></i> ایجاد درخواست جدید
                    </button>
                </div>
            </div>
            
            <div class="stats-grid" id="dashboard-stats"></div>
            
            <div class="dashboard-actions">
                <button class="btn btn-secondary" onclick="window.loadAllRequests()">
                    <i class="fas fa-list"></i> همه درخواست‌ها
                </button>
                <button class="btn btn-primary" onclick="window.showNewRequestModal()">
                    <i class="fas fa-plus"></i> ایجاد درخواست جدید
                </button>
                <button class="btn btn-info" onclick="window.loadShedRequests()">
                    <i class="fas fa-warehouse"></i> درخواست‌های سوله
                </button>
            </div>
            
            <div id="dashboard-content">
                <div class="requests-list">
                    <div class="request-item">
                        <p style="text-align: center; color: var(--muted);">لطفاً یک گزینه از بالا انتخاب کنید.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه پنل ادمین -->
    <section id="admin-page" class="page hidden">
        <div class="container admin-panel">
            <h2 class="section-title">پنل مدیریت ادمین</h2>
            
            <div class="admin-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                <div class="admin-stat-card" style="background: white; border-radius: 10px; padding: 1.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center;">
                    <h3 style="color: var(--muted); font-size: 0.9rem;">تعداد کل کاربران</h3>
                    <div class="value" id="admin-total-users" style="font-size: 2rem; font-weight: bold; color: var(--primary);">۰</div>
                </div>
                <div class="admin-stat-card">
                    <h3 style="color: var(--muted); font-size: 0.9rem;">تعداد خریداران</h3>
                    <div class="value" id="admin-total-buyers" style="font-size: 2rem; font-weight: bold; color: var(--primary);">۰</div>
                </div>
                <div class="admin-stat-card">
                    <h3 style="color: var(--muted); font-size: 0.9rem;">فروشندگان قالب</h3>
                    <div class="value" id="admin-formwork-sellers" style="font-size: 2rem; font-weight: bold; color: var(--primary);">۰</div>
                </div>
                <div class="admin-stat-card">
                    <h3 style="color: var(--muted); font-size: 0.9rem;">فروشندگان سوله</h3>
                    <div class="value" id="admin-shed-sellers" style="font-size: 2rem; font-weight: bold; color: var(--primary);">۰</div>
                </div>
                <div class="admin-stat-card">
                    <h3 style="color: var(--muted); font-size: 0.9rem;">کل درخواست‌ها</h3>
                    <div class="value" id="admin-total-requests" style="font-size: 2rem; font-weight: bold; color: var(--primary);">۰</div>
                </div>
                <div class="admin-stat-card">
                    <h3 style="color: var(--muted); font-size: 0.9rem;">تراکنش‌های موفق</h3>
                    <div class="value" id="admin-total-transactions" style="font-size: 2rem; font-weight: bold; color: var(--primary);">۰</div>
                </div>
            </div>
            
            <div class="admin-actions" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                <button class="btn btn-primary" onclick="window.loadAllUsers()">
                    <i class="fas fa-users"></i> مدیریت کاربران
                </button>
                <button class="btn btn-primary" onclick="window.loadAllRequests()">
                    <i class="fas fa-clipboard-list"></i> همه درخواست‌ها
                </button>
                <button class="btn btn-primary" onclick="window.loadAllShedRequests()">
                    <i class="fas fa-warehouse"></i> درخواست‌های سوله
                </button>
                <button class="btn btn-primary" onclick="window.loadAllTransactions()">
                    <i class="fas fa-exchange-alt"></i> مشاهده تراکنش‌ها
                </button>
            </div>
            
            <div id="admin-content">
                <div class="requests-list" style="background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <div class="request-item" style="padding: 1.5rem;">
                        <p style="text-align: center; color: var(--muted);">لطفاً یک گزینه از بالا انتخاب کنید.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه داشبورد فروشنده قالب (رفع مشکل) -->
    <section id="seller-formwork-dashboard-page" class="page hidden">
        <div class="container dashboard">
            <div class="dashboard-header">
                <div class="user-info">
                    <div class="user-avatar">🏗️</div>
                    <div>
                        <h2>داشبورد فروشنده قالب</h2>
                        <p id="seller-formwork-name">در حال بارگذاری...</p>
                    </div>
                </div>
                <button class="btn btn-danger" onclick="window.logout()">خروج</button>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>پیشنهادات ارسالی</h3>
                    <div class="value">۰</div>
                </div>
                <div class="stat-card">
                    <h3>پیشنهادات منتخب</h3>
                    <div class="value">۰</div>
                </div>
                <div class="stat-card">
                    <h3>در انتظار بررسی</h3>
                    <div class="value">۰</div>
                </div>
                <div class="stat-card">
                    <h3>امتیاز شما</h3>
                    <div class="value">۰</div>
                </div>
            </div>
            
            <div style="margin-top: 2rem;">
                <h3 style="color: var(--primary); margin-bottom: 1rem;">درخواست‌های جدید قالب</h3>
                <div id="seller-formwork-requests" class="requests-list">
                    <div class="request-item">
                        <p style="text-align: center; color: var(--muted);">در حال بارگذاری درخواست‌ها...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- صفحه داشبورد فروشنده سوله (رفع مشکل) -->
    <section id="seller-shed-dashboard-page" class="page hidden">
        <div class="container dashboard">
            <div class="dashboard-header">
                <div class="user-info">
                    <div class="user-avatar">🏭</div>
                    <div>
                        <h2>داشبورد فروشنده سوله</h2>
                        <p id="seller-shed-name">در حال بارگذاری...</p>
                    </div>
                </div>
                <button class="btn btn-danger" onclick="window.logout()">خروج</button>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>پیشنهادات ارسالی</h3>
                    <div class="value">۰</div>
                </div>
                <div class="stat-card">
                    <h3>پیشنهادات منتخب</h3>
                    <div class="value">۰</div>
                </div>
                <div class="stat-card">
                    <h3>در انتظار بررسی</h3>
                    <div class="value">۰</div>
                </div>
                <div class="stat-card">
                    <h3>امتیاز شما</h3>
                    <div class="value">۰</div>
                </div>
            </div>
            
            <div style="margin-top: 2rem;">
                <h3 style="color: var(--primary); margin-bottom: 1rem;">درخواست‌های جدید سوله</h3>
                <div id="seller-shed-requests" class="requests-list">
                    <div class="request-item">
                        <p style="text-align: center; color: var(--muted);">در حال بارگذاری درخواست‌ها...</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ========== مودال‌ها ========== -->
    
    <!-- مودال ایجاد درخواست جدید -->
    <div id="new-request-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ایجاد درخواست جدید</h3>
                <button class="close-modal" onclick="window.closeModal('new-request-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="new-request-form">
                    <div class="form-group">
                        <label for="request-title">عنوان درخواست</label>
                        <input type="text" id="request-title" class="form-control" required placeholder="مثال: قالب مدولار برای پروژه مسکونی 10 طبقه">
                    </div>
                    
                    <div class="form-group">
                        <label for="request-description">توضیحات</label>
                        <textarea id="request-description" class="form-control" rows="3" required placeholder="جزئیات پروژه، ابعاد مورد نیاز، مشخصات فنی..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>انتخاب اقلام درخواستی</label>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.5rem;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="request-items" value="مدولار"> قالب مدولار
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="request-items" value="خاص"> قالب خاص
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="request-items" value="تونلفرم"> تونلفرم
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="request-items" value="داربست"> داربست
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="request-items" value="کاپلاک"> کاپلاک
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" name="request-items" value="ملحقات"> ملحقات
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="request-material">جنس قالب</label>
                        <select id="request-material" class="form-control" required>
                            <option value="">-- انتخاب کنید --</option>
                            <option value="ورق رویه فولاد مبارکه">ورق رویه فولاد مبارکه</option>
                            <option value="ورق رویه و تسمه فولاد مبارکه">ورق رویه و تسمه فولاد مبارکه</option>
                            <option value="سایر">سایر</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="request-project-location">محل اجرای پروژه</label>
                        <input type="text" id="request-project-location" class="form-control" required placeholder="مثال: تهران">
                    </div>
                    
                    <div class="form-group">
                        <label for="request-deadline">مهلت ارسال پیشنهاد</label>
                        <div class="date-selector" style="display: flex; gap: 10px;">
                            <select id="request-deadline-year" class="form-control" required>
                                <option value="">سال</option>
                                <option value="1404">۱۴۰۴</option>
                                <option value="1405">۱۴۰۵</option>
                                <option value="1406">۱۴۰۶</option>
                            </select>
                            <select id="request-deadline-month" class="form-control" required>
                                <option value="">ماه</option>
                                <option value="01">فروردین</option>
                                <option value="02">اردیبهشت</option>
                                <option value="03">خرداد</option>
                                <option value="04">تیر</option>
                                <option value="05">مرداد</option>
                                <option value="06">شهریور</option>
                                <option value="07">مهر</option>
                                <option value="08">آبان</option>
                                <option value="09">آذر</option>
                                <option value="10">دی</option>
                                <option value="11">بهمن</option>
                                <option value="12">اسفند</option>
                            </select>
                            <select id="request-deadline-day" class="form-control" required>
                                <option value="">روز</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>آپلود عکس نمونه (اختیاری)</label>
                        <div class="image-upload-container" style="border: 2px dashed #d1d5db; border-radius: 6px; padding: 2rem; text-align: center; cursor: pointer;" onclick="document.getElementById('request-image-upload').click()">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--muted);"></i>
                            <p>برای آپلود عکس کلیک کنید</p>
                            <input type="file" id="request-image-upload" accept="image/*" style="display: none;" onchange="window.previewRequestImage(event)">
                            <img id="request-image-preview" class="image-preview" style="max-width: 100%; max-height: 300px; margin-top: 1rem; border-radius: 6px; display: none;">
                        </div>
                        <div id="uploaded-images"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="window.closeModal('new-request-modal')">انصراف</button>
                <button class="btn btn-primary" onclick="window.submitNewRequest()">ثبت درخواست</button>
            </div>
        </div>
    </div>

    <!-- مودال ارسال پیشنهاد قالب -->
    <div id="submit-bid-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ارسال پیشنهاد قیمت</h3>
                <button class="close-modal" onclick="window.closeModal('submit-bid-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="background: #eff6ff; padding: 10px 15px; border-radius: 6px; margin-bottom: 20px; border-right: 4px solid var(--primary);">
                    <strong>پروژه:</strong> <span id="bid-project-title">در حال بارگذاری...</span>
                </div>
                
                <form id="submit-bid-form">
                    <input type="hidden" id="bid-request-id">
                    
                    <div class="form-group">
                        <label for="bid-base-price">قیمت کل پیشنهادی (ریال)</label>
                        <input type="text" id="bid-base-price" class="form-control" required oninput="window.formatPriceInput(this)" placeholder="مثال: ۱۰,۰۰۰,۰۰۰,۰۰۰">
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-vat-percentage">درصد ارزش افزوده</label>
                        <select id="bid-vat-percentage" class="form-control" onchange="window.calculateTotalPrice()">
                            <option value="10">10%</option>
                            <option value="15" selected>15%</option>
                            <option value="20">20%</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-loading-percentage">درصد بارگیری</label>
                        <select id="bid-loading-percentage" class="form-control" onchange="window.calculateTotalPrice()">
                            <option value="1">1%</option>
                            <option value="2" selected>2%</option>
                            <option value="3">3%</option>
                        </select>
                    </div>
                    
                    <div class="price-breakdown" style="background: #f8fafc; border-radius: 6px; padding: 15px; margin-top: 15px;">
                        <div class="price-row" style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <span>قیمت پایه:</span>
                            <span id="display-base-price">0 ریال</span>
                        </div>
                        <div class="price-row">
                            <span>ارزش افزوده:</span>
                            <span id="display-vat-amount">0 ریال</span>
                        </div>
                        <div class="price-row">
                            <span>بارگیری:</span>
                            <span id="display-loading-amount">0 ریال</span>
                        </div>
                        <div class="price-row total" style="font-weight: bold; color: var(--primary); border-top: 2px solid var(--primary); padding-top: 10px; margin-top: 10px;">
                            <span>قیمت کل:</span>
                            <span id="display-total-price">0 ریال</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-delivery">زمان تحویل (روز)</label>
                        <input type="number" id="bid-delivery" class="form-control" value="30" required min="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-warranty">گارانتی (ماه)</label>
                        <input type="number" id="bid-warranty" class="form-control" value="12" required min="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="bid-notes">توضیحات (اختیاری)</label>
                        <textarea id="bid-notes" class="form-control" rows="3" placeholder="توضیحات اضافی..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="window.closeModal('submit-bid-modal')">انصراف</button>
                <button class="btn btn-primary" onclick="window.submitBid()">ارسال پیشنهاد</button>
            </div>
        </div>
    </div>

    <!-- فوتر -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>B2BSteel</h3>
                    <p>اولین پلتفرم تخصصی ارتباط مستقیم بین خریداران و فروشندگان قالب‌های فلزی بتن و سوله در ایران</p>
                </div>
                
                <div class="footer-section">
                    <h3>لینک‌های سریع</h3>
                    <ul style="list-style: none;">
                        <li><a href="#" onclick="window.showPage('home')">خانه</a></li>
                        <li><a href="#" onclick="window.showPage('concrete-formwork')">قالب بتن</a></li>
                        <li><a href="#" onclick="window.showPage('shed')">سوله</a></li>
                        <li><a href="#" onclick="window.showPage('blog')">بلاگ</a></li>
                        <li><a href="#" onclick="window.showPage('terms')">قوانین</a></li>
                        <li><a href="#" onclick="window.showPage('guide')">راهنما</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>تماس با ما</h3>
                    <ul style="list-style: none;">
                        <li><i class="fas fa-phone"></i> ۰۲۱-۱۲۳۴۵۶۷۸</li>
                        <li><i class="fas fa-envelope"></i> info@b2bsteel.ir</li>
                        <li><i class="fas fa-map-marker-alt"></i> تهران، خیابان ولیعصر</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>© ۱۴۰۴ کلیه حقوق برای پلتفرم B2BSteel محفوظ است.</p>
            </div>
        </div>
    </footer>
</main>

<!-- ========== کتابخانه‌ها و اسکریپت اصلی ========== -->
<script type="importmap">
    {
        "imports": {
            "@supabase/supabase-js": "https://esm.sh/@supabase/supabase-js@2"
        }
    }
</script>
<script type="module" src="supabaseClient.js"></script>

<script type="module">
    // ========== 1. ایمپورت و متغیرهای سراسری ==========
    import { supabase } from './supabaseClient.js';
    
    console.log('✅ Script loaded, defining window functions...');
    window.supabase = supabase;

    // ========== تعریف showPage در اولین خط ==========
    window.showPage = function(pageId) {
        console.log('showPage called with:', pageId);
        document.querySelectorAll('.modal').forEach(modal => modal.classList.remove('active'));
        document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
        const targetPage = document.getElementById(`${pageId}-page`);
        if (targetPage) targetPage.classList.remove('hidden');
        if (typeof window.updateNavigation === 'function') window.updateNavigation();
        
        // توابع وابسته به صفحه
        if (pageId === 'dashboard' && currentUser?.userType === 'buyer') window.loadDashboard();
        else if (pageId === 'admin' && currentUser?.isAdmin) window.loadAdminPanel();
        else if (pageId === 'seller-formwork-dashboard' && currentUser?.userType === 'seller' && currentUser?.sellerType === 'formwork') window.loadSellerFormworkDashboard();
        else if (pageId === 'seller-shed-dashboard' && currentUser?.userType === 'seller' && currentUser?.sellerType === 'shed') window.loadSellerShedDashboard();
        else if (pageId === 'home') { window.loadCounters(); window.initImageSlider(); }
    };
    
    // متغیرهای اصلی
    let currentUser = JSON.parse(localStorage.getItem('current_user')) || null;
    window.currentUser = currentUser;
    
    let selectedUserType = 'buyer';
    let selectedUserLegalType = 'company';
    let selectedSellerType = 'formwork';
    let currentRequestImages = [];
    let currentBidImages = [];
    let currentRating = 0;

    // ========== 2. توابع کمکی ==========
    window.toPersianNumbers = function(num) {
        const persianDigits = ['۰', '۱', '۲', '۳', '۴', '۵', '۶', '۷', '۸', '۹'];
        return num.toString().replace(/\d/g, x => persianDigits[x]);
    };

    window.toEnglishNumbers = function(str) {
        const persianDigits = ['۰', '۱', '۲', '۳', '۴', '۵', '۶', '۷', '۸', '۹'];
        const englishDigits = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];
        let result = str;
        for (let i = 0; i < 10; i++) {
            result = result.replace(new RegExp(persianDigits[i], 'g'), englishDigits[i]);
        }
        return result;
    };

    window.formatNumberFarsiDisplay = function(number) {
        return number.toLocaleString('fa-IR');
    };

    window.parseFormattedNumber = function(formattedValue) {
        if (!formattedValue) return 0;
        let value = window.toEnglishNumbers(formattedValue);
        value = value.replace(/[^\d]/g, '');
        const num = parseInt(value);
        return isNaN(num) ? 0 : num;
    };

    window.formatPriceInput = function(input) {
        let value = input.value;
        if (!value) return;
        value = window.toEnglishNumbers(value);
        value = value.replace(/[^\d]/g, '');
        if (!value) {
            input.value = '';
            return;
        }
        const num = parseInt(value);
        input.value = num.toLocaleString('fa-IR');
        if (typeof window.calculateTotalPrice === 'function') window.calculateTotalPrice();
    };

    // ========== 3. توابع ناوبری ==========
    window.updateNavigation = function() {
        const authButtons = document.getElementById('auth-buttons');
        const userMenu = document.getElementById('user-menu');
        const sellerFormworkMenu = document.getElementById('seller-formwork-menu');
        const sellerShedMenu = document.getElementById('seller-shed-menu');
        const adminMenu = document.getElementById('admin-menu');
        
        if (!authButtons || !userMenu) return;
        
        if (currentUser) {
            authButtons.classList.add('hidden');
            if (currentUser.isAdmin) {
                adminMenu?.classList.remove('hidden');
                userMenu?.classList.add('hidden');
                sellerFormworkMenu?.classList.add('hidden');
                sellerShedMenu?.classList.add('hidden');
            } else if (currentUser.userType === 'buyer') {
                userMenu?.classList.remove('hidden');
                adminMenu?.classList.add('hidden');
                sellerFormworkMenu?.classList.add('hidden');
                sellerShedMenu?.classList.add('hidden');
            } else if (currentUser.userType === 'seller' && currentUser.sellerType === 'formwork') {
                sellerFormworkMenu?.classList.remove('hidden');
                userMenu?.classList.add('hidden');
                adminMenu?.classList.add('hidden');
                sellerShedMenu?.classList.add('hidden');
            } else if (currentUser.userType === 'seller' && currentUser.sellerType === 'shed') {
                sellerShedMenu?.classList.remove('hidden');
                userMenu?.classList.add('hidden');
                adminMenu?.classList.add('hidden');
                sellerFormworkMenu?.classList.add('hidden');
            }
        } else {
            authButtons.classList.remove('hidden');
            userMenu?.classList.add('hidden');
            sellerFormworkMenu?.classList.add('hidden');
            sellerShedMenu?.classList.add('hidden');
            adminMenu?.classList.add('hidden');
        }
    };

    window.closeModal = function(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) modal.classList.remove('active');
    };

    // ========== 4. توابع احراز هویت ==========
    window.handleLogin = async function(email, password) {
        try {
            const { data, error } = await supabase.auth.signInWithPassword({ email, password });
            if (error) throw error;
            
            const { data: profile } = await supabase
                .from('profiles')
                .select('*')
                .eq('user_id', data.user.id)
                .single();
            
            currentUser = {
                id: data.user.id,
                email: data.user.email,
                userType: profile?.user_type || 'buyer',
                sellerType: profile?.seller_type,
                full_name: profile?.full_name,
                companyName: profile?.company_name,
                userLegalType: profile?.user_legal_type,
                isAdmin: profile?.role === 'admin' || false
            };
            
            localStorage.setItem('current_user', JSON.stringify(currentUser));
            window.currentUser = currentUser;
            return { success: true, user: currentUser };
        } catch (error) {
            console.error('Login error:', error);
            return { success: false, error: error.message };
        }
    };

    window.handleRegister = async function(userData) {
        try {
            const { data: authData, error: authError } = await supabase.auth.signUp({
                email: userData.email,
                password: userData.password,
                options: {
                    data: {
                        full_name: userData.contactPerson,
                        phone: userData.phone,
                        user_type: userData.userType,
                        seller_type: userData.sellerType,
                        company_name: userData.company,
                        position: userData.position,
                        user_legal_type: userData.userLegalType
                    }
                }
            });
            if (authError) throw authError;
            
            if (authData.user) {
                const { error: profileError } = await supabase
                    .from('profiles')
                    .insert([{
                        user_id: authData.user.id,
                        email: userData.email,
                        full_name: userData.contactPerson,
                        phone: userData.phone,
                        user_type: userData.userType,
                        seller_type: userData.sellerType,
                        company_name: userData.company,
                        position: userData.position,
                        user_legal_type: userData.userLegalType,
                        verification_status: 'pending',
                        role: 'user'
                    }]);
                if (profileError) console.warn('Profile warning:', profileError);
                
                currentUser = {
                    id: authData.user.id,
                    email: userData.email,
                    userType: userData.userType,
                    sellerType: userData.sellerType,
                    full_name: userData.contactPerson,
                    companyName: userData.company,
                    userLegalType: userData.userLegalType,
                    isAdmin: false
                };
                localStorage.setItem('current_user', JSON.stringify(currentUser));
                window.currentUser = currentUser;
            }
            return { success: true, user: currentUser };
        } catch (error) {
            console.error('Register error:', error);
            return { success: false, error: error.message };
        }
    };

    window.logout = async function() {
        await supabase.auth.signOut();
        currentUser = null;
        localStorage.removeItem('current_user');
        window.currentUser = null;
        window.showPage('home');
        alert('با موفقیت خارج شدید.');
    };

    // ========== 5. توابع انتخاب نوع کاربر ==========
    window.selectUserType = function(type) {
        selectedUserType = type;
        const mainSelector = document.getElementById('user-type-main-selector');
        if (mainSelector) {
            mainSelector.querySelectorAll('.user-type-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === type);
            });
        }
        const sellerSection = document.getElementById('seller-type-section');
        if (sellerSection) sellerSection.classList.toggle('hidden', type !== 'seller');
    };

    window.selectUserLegalType = function(type) {
        selectedUserLegalType = type;
        const legalSelector = document.getElementById('user-legal-type-selector');
        if (legalSelector) {
            legalSelector.querySelectorAll('.user-type-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === type);
            });
        }
        const companyFields = document.getElementById('company-fields');
        const companyLabel = document.getElementById('company-label');
        if (companyFields && companyLabel) {
            if (type === 'company') {
                companyFields.style.display = 'block';
                companyLabel.textContent = 'نام شرکت *';
                document.getElementById('reg-company').required = true;
            } else {
                companyFields.style.display = 'none';
                companyLabel.textContent = 'نام شرکت (اختیاری)';
                document.getElementById('reg-company').required = false;
            }
        }
    };

    window.selectSellerType = function(type) {
        selectedSellerType = type;
        const sellerSelector = document.getElementById('seller-type-selector');
        if (sellerSelector) {
            sellerSelector.querySelectorAll('.user-type-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === type);
            });
        }
    };

    // ========== 6. توابع فرم درخواست بتن ==========
    window.showNewRequestModal = function() {
        if (!currentUser) {
            alert('لطفاً وارد شوید.');
            window.showPage('login');
            return;
        }
        const modal = document.getElementById('new-request-modal');
        if (modal) modal.classList.add('active');
        
        // تنظیم تاریخ پیشفرض
        const futureDate = new Date();
        futureDate.setDate(futureDate.getDate() + 30);
        const yearSelect = document.getElementById('request-deadline-year');
        const monthSelect = document.getElementById('request-deadline-month');
        const daySelect = document.getElementById('request-deadline-day');
        
        if (yearSelect) yearSelect.value = (futureDate.getFullYear() - 621).toString();
        if (monthSelect) monthSelect.value = (futureDate.getMonth() + 1).toString().padStart(2, '0');
        
        if (daySelect) {
            daySelect.innerHTML = '<option value="">روز</option>';
            const daysInMonth = new Date(futureDate.getFullYear(), futureDate.getMonth() + 1, 0).getDate();
            for (let i = 1; i <= daysInMonth; i++) {
                const option = document.createElement('option');
                option.value = i.toString().padStart(2, '0');
                option.textContent = window.toPersianNumbers(i);
                if (i === futureDate.getDate()) option.selected = true;
                daySelect.appendChild(option);
            }
        }
    };

    window.previewRequestImage = function(event) {
        const input = event.target;
        const preview = document.getElementById('request-image-preview');
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.style.display = 'block';
                currentRequestImages.push(e.target.result);
            };
            reader.readAsDataURL(input.files[0]);
        }
    };

    window.submitNewRequest = async function() {
        const { data: { user } } = await supabase.auth.getUser();
        if (!user) {
            alert('لطفاً وارد شوید.');
            window.showPage('login');
            return;
        }
        
        const title = document.getElementById('request-title')?.value;
        const description = document.getElementById('request-description')?.value;
        const material = document.getElementById('request-material')?.value;
        const location = document.getElementById('request-project-location')?.value;
        const year = document.getElementById('request-deadline-year')?.value;
        const month = document.getElementById('request-deadline-month')?.value;
        const day = document.getElementById('request-deadline-day')?.value;
        
        const selectedItems = Array.from(document.querySelectorAll('input[name="request-items"]:checked')).map(cb => cb.value);
        
        if (!title || !description || !material || !location || !year || !month || !day) {
            alert('لطفاً همه فیلدها را پر کنید.');
            return;
        }
        
        try {
            const { error } = await supabase
                .from('concrete_requests')
                .insert([{
                    user_id: user.id,
                    title,
                    description,
                    items: selectedItems,
                    material,
                    project_location: location,
                    deadline: `${year}/${month}/${day}`,
                    status: 'open',
                    images: currentRequestImages,
                    created_at: new Date().toISOString()
                }]);
            
            if (error) throw error;
            
            alert('✅ درخواست با موفقیت ثبت شد!');
            window.closeModal('new-request-modal');
            document.getElementById('new-request-form')?.reset();
            currentRequestImages = [];
        } catch (error) {
            console.error('Error:', error);
            alert('خطا در ثبت درخواست: ' + error.message);
        }
    };

    // ========== 7. توابع صفحه اصلی ==========
    window.loadCounters = async function() {
        try {
            const { count: sellers } = await supabase
                .from('profiles')
                .select('*', { count: 'exact', head: true })
                .eq('user_type', 'seller');
            
            const { count: buyers } = await supabase
                .from('profiles')
                .select('*', { count: 'exact', head: true })
                .eq('user_type', 'buyer');
            
            // تعداد تراکنش‌های موفق (فعلاً ۰)
            const transactions = 0;
            
            document.getElementById('counter-sellers').textContent = sellers || 0;
            document.getElementById('counter-buyers').textContent = buyers || 0;
            document.getElementById('counter-transactions').textContent = transactions;
        } catch (error) {
            console.error('❌ خطا در شمارنده‌ها:', error);
        }
    };

    window.initImageSlider = function() {
        const images = document.querySelectorAll('.slider-image');
        if (images.length === 0) return;
        let currentIndex = 0;
        setInterval(() => {
            images[currentIndex].classList.remove('active');
            currentIndex = (currentIndex + 1) % images.length;
            images[currentIndex].classList.add('active');
        }, 5000);
    };

    // ========== پنل ادمین واقعی ==========
    window.loadAdminPanel = async function() {
        if (!currentUser?.isAdmin) {
            window.showPage('home');
            return;
        }

        try {
            // 1. تعداد کل کاربران
            const { count: totalUsers } = await supabase
                .from('profiles')
                .select('*', { count: 'exact', head: true });

            // 2. تعداد خریداران
            const { count: totalBuyers } = await supabase
                .from('profiles')
                .select('*', { count: 'exact', head: true })
                .eq('user_type', 'buyer');

            // 3. تعداد فروشندگان قالب
            const { count: formworkSellers } = await supabase
                .from('profiles')
                .select('*', { count: 'exact', head: true })
                .eq('user_type', 'seller')
                .eq('seller_type', 'formwork');

            // 4. تعداد فروشندگان سوله
            const { count: shedSellers } = await supabase
                .from('profiles')
                .select('*', { count: 'exact', head: true })
                .eq('user_type', 'seller')
                .eq('seller_type', 'shed');

            // 5. تعداد کل درخواست‌ها (بتن + سوله)
            const { count: concreteRequests } = await supabase
                .from('concrete_requests')
                .select('*', { count: 'exact', head: true });

            const { count: shedRequests } = await supabase
                .from('shed_requests')
                .select('*', { count: 'exact', head: true });

            // 6. تعداد تراکنش‌های موفق (فعلاً 0)
            const totalTransactions = 0;

            // نمایش آمار واقعی
            document.getElementById('admin-total-users').textContent = totalUsers || 0;
            document.getElementById('admin-total-buyers').textContent = totalBuyers || 0;
            document.getElementById('admin-formwork-sellers').textContent = formworkSellers || 0;
            document.getElementById('admin-shed-sellers').textContent = shedSellers || 0;
            document.getElementById('admin-total-requests').textContent = (concreteRequests || 0) + (shedRequests || 0);
            document.getElementById('admin-total-transactions').textContent = totalTransactions;

        } catch (error) {
            console.error('❌ خطا در پنل ادمین:', error);
        }
    };
    
    // ========== نمایش لیست کاربران در پنل ادمین ==========
    window.loadAllUsers = async function() {
        console.log('👥 بارگذاری لیست کاربران');
        
        const content = document.getElementById('admin-content');
        if (!content) {
            console.log('❌ المان admin-content پیدا نشد');
            return;
        }

        content.innerHTML = '<div style="text-align: center; padding: 2rem;">⏳ در حال بارگذاری...</div>';

        try {
            const { data: users, error } = await supabase
                .from('profiles')
                .select('*')
                .order('created_at', { ascending: false });

            if (error) throw error;

            if (!users || users.length === 0) {
                content.innerHTML = '<div style="text-align: center; padding: 2rem;">👥 کاربری یافت نشد</div>';
                return;
            }

            let html = '<div class="requests-list">';
            
            users.forEach(user => {
                let userTypeText = '';
                let badgeClass = 'badge-info';
                
                if (user.role === 'admin') {
                    userTypeText = '👑 ادمین';
                    badgeClass = 'badge-warning';
                } else if (user.user_type === 'buyer') {
                    userTypeText = '🛒 خریدار';
                    badgeClass = 'badge-open';
                } else if (user.user_type === 'seller') {
                    if (user.seller_type === 'formwork') {
                        userTypeText = '🏗️ فروشنده قالب';
                        badgeClass = 'badge-success';
                    } else if (user.seller_type === 'shed') {
                        userTypeText = '🏭 فروشنده سوله';
                        badgeClass = 'badge-info';
                    } else {
                        userTypeText = '📦 فروشنده';
                    }
                } else {
                    userTypeText = '👤 کاربر';
                }

                html += `
                    <div class="request-item">
                        <div class="request-header">
                            <div class="request-title">${user.full_name || 'بدون نام'}</div>
                            <span class="request-badge ${badgeClass}">${userTypeText}</span>
                        </div>
                        <div class="request-details">
                            <div><strong>ایمیل:</strong> ${user.email}</div>
                            <div><strong>شرکت:</strong> ${user.company_name || '—'}</div>
                            <div><strong>تلفن:</strong> ${user.phone || '—'}</div>
                            <div><strong>تاریخ ثبت:</strong> ${new Date(user.created_at).toLocaleDateString('fa-IR')}</div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            content.innerHTML = html;

        } catch (error) {
            console.error('❌ خطا:', error);
            content.innerHTML = '<div style="color: red; text-align: center; padding: 2rem;">❌ خطا در بارگذاری کاربران</div>';
        }
    };
    
    // ========== تابع داشبورد خریدار ==========
    window.loadDashboard = function() {
        console.log('🚀 loadDashboard اجرا شد');
        
        if (!currentUser) {
            console.log('❌ currentUser نیست');
            return;
        }

        const nameEl = document.getElementById('user-name');
        if (nameEl) {
            nameEl.textContent = currentUser.full_name || 
                                currentUser.contactPerson || 
                                currentUser.email?.split('@')[0] || 
                                'کاربر';
        }

        const typeEl = document.getElementById('user-type');
        if (typeEl) {
            let typeText = 'کاربر عادی';
            if (currentUser.isAdmin) typeText = 'مدیر سیستم';
            else if (currentUser.userType === 'seller') typeText = 'فروشنده';
            else if (currentUser.userType === 'buyer') typeText = 'خریدار';
            
            typeEl.textContent = `نوع حساب: ${typeText}`;
        }

        const avatarEl = document.getElementById('user-avatar');
        if (avatarEl) {
            const firstChar = (currentUser.full_name || currentUser.email || '?').charAt(0).toUpperCase();
            avatarEl.textContent = firstChar;
        }

        const actionsEl = document.getElementById('buyer-actions');
        if (actionsEl) actionsEl.classList.remove('hidden');
    };
    
    // ========== تابع داشبورد فروشنده قالب (جدید) ==========
    window.loadSellerFormworkDashboard = async function() {
        console.log('🏗️ بارگذاری داشبورد فروشنده قالب');
        
        if (!currentUser) return;
        
        const nameEl = document.getElementById('seller-formwork-name');
        if (nameEl) {
            nameEl.textContent = currentUser.full_name || currentUser.email || 'فروشنده قالب';
        }
        
        try {
            const { data: requests, error } = await supabase
                .from('concrete_requests')
                .select('*')
                .eq('status', 'open')
                .order('created_at', { ascending: false });
            
            if (error) throw error;
            
            const container = document.getElementById('seller-formwork-requests');
            if (!container) return;
            
            if (!requests || requests.length === 0) {
                container.innerHTML = '<div class="request-item"><p style="text-align: center;">درخواستی وجود ندارد</p></div>';
                return;
            }
            
            let html = '';
            requests.forEach(req => {
                html += `
                    <div class="request-item">
                        <div><strong>عنوان:</strong> ${req.title || 'بدون عنوان'}</div>
                        <div><strong>محل:</strong> ${req.project_location || 'نامشخص'}</div>
                        <div><strong>توضیحات:</strong> ${req.description?.substring(0, 50)}...</div>
                        <button class="btn btn-primary btn-sm" onclick="alert('ارسال پیشنهاد - در حال توسعه')">ارسال پیشنهاد</button>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
        } catch (error) {
            console.error('❌ خطا در بارگذاری درخواست‌های قالب:', error);
            const container = document.getElementById('seller-formwork-requests');
            if (container) {
                container.innerHTML = '<div style="color: red; text-align: center;">خطا در بارگذاری</div>';
            }
        }
    };
    
    // ========== تابع داشبورد فروشنده سوله ==========
    window.loadSellerShedDashboard = async function() {
        console.log('🏭 بارگذاری داشبورد فروشنده سوله');
        
        if (!currentUser) return;
        
        const nameEl = document.getElementById('seller-shed-name');
        if (nameEl) {
            nameEl.textContent = currentUser.full_name || currentUser.email || 'فروشنده سوله';
        }
        
        try {
            const { data: requests, error } = await supabase
                .from('shed_requests')
                .select('*')
                .eq('status', 'open')
                .order('created_at', { ascending: false });
            
            if (error) throw error;
            
            const container = document.getElementById('seller-shed-requests');
            if (!container) return;
            
            if (!requests || requests.length === 0) {
                container.innerHTML = '<div class="request-item"><p style="text-align: center;">درخواستی وجود ندارد</p></div>';
                return;
            }
            
            let html = '';
            requests.forEach(req => {
                html += `
                    <div class="request-item">
                        <div><strong>کاربری:</strong> ${req.usage || 'بدون توضیح'}</div>
                        <div><strong>مکان:</strong> ${req.location || 'نامشخص'}</div>
                        <div><strong>ابعاد:</strong> ${req.dimensions?.length || '?'}×${req.dimensions?.width || '?'}×${req.dimensions?.height || '?'}</div>
                        <button class="btn btn-primary btn-sm" onclick="alert('ارسال پیشنهاد - در حال توسعه')">ارسال پیشنهاد</button>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
        } catch (error) {
            console.error('❌ خطا در بارگذاری درخواست‌های سوله:', error);
            const container = document.getElementById('seller-shed-requests');
            if (container) {
                container.innerHTML = '<div style="color: red; text-align: center;">خطا در بارگذاری</div>';
            }
        }
    };
    
    // ========== 9. توابع سوله ==========
    window.toggleDrawingUpload = function(show) {
        const section = document.getElementById('drawing-upload-section');
        if (section) section.classList.toggle('hidden', !show);
    };

    window.toggleCraneDetails = function(show) {
        const section = document.getElementById('crane-details-section');
        if (section) section.classList.toggle('hidden', !show);
    };

    window.toggleOtherPaintType = function() {
        const paintType = document.getElementById('paint-type');
        const otherPaint = document.getElementById('other-paint-type');
        if (paintType && otherPaint) {
            otherPaint.classList.toggle('hidden', paintType.value !== 'other');
        }
    };

    window.loadSecondhandSheds = function() {
        window.showPage('secondhand-shed');
        const container = document.getElementById('shed-listings');
        if (container) {
            container.innerHTML = '<div class="shed-listing-item"><p style="text-align: center;">در حال بارگذاری آگهی‌ها...</p></div>';
        }
    };

    // ========== 10. سیستم قالب بتن ==========
    window.enterConcreteFormworkSystem = function() {
        if (currentUser) {
            if (currentUser.userType === 'buyer') window.showPage('dashboard');
            else if (currentUser.userType === 'seller' && currentUser.sellerType === 'formwork') window.showPage('seller-formwork-dashboard');
            else if (currentUser.userType === 'seller' && currentUser.sellerType === 'shed') window.showPage('seller-shed-dashboard');
            else if (currentUser.isAdmin) window.showPage('admin');
        } else {
            window.showPage('login');
        }
    };

    // ========== 11. قابلیت بازیابی رمز عبور (جدید) ==========
    document.getElementById('forgot-password-form')?.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = document.getElementById('reset-email').value;
        const resetMessage = document.getElementById('reset-message');
        const resetError = document.getElementById('reset-error');
        
        resetMessage.textContent = '';
        resetError.textContent = '';
        
        try {
            const { error } = await supabase.auth.resetPasswordForEmail(email, {
                redirectTo: window.location.origin + '/reset-password',
            });
            
            if (error) throw error;
            
            resetMessage.textContent = '✅ لینک بازیابی رمز عبور به ایمیل شما ارسال شد. لطفاً ایمیل خود را بررسی کنید.';
            document.getElementById('reset-email').value = '';
        } catch (error) {
            console.error('❌ خطا در بازیابی رمز:', error);
            resetError.textContent = error.message || 'خطا در ارسال ایمیل. لطفاً دوباره تلاش کنید.';
        }
    });

    // ========== 12. Event Listeners ==========
    document.addEventListener('DOMContentLoaded', function() {
        console.log('✅ B2BSteel با موفقیت بارگذاری شد');
        
        // فرم ثبت‌نام
        document.getElementById('register-form')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // بررسی پذیرش قوانین
            const acceptTerms = document.getElementById('accept-terms');
            if (!acceptTerms || !acceptTerms.checked) {
                alert('❌ برای ثبت‌نام باید قوانین و شرایط پلتفرم را بپذیرید.');
                return;
            }
            
            const password = document.getElementById('reg-password').value;
            const confirm = document.getElementById('reg-password-confirm').value;
            
            if (password !== confirm) {
                document.getElementById('password-match-error').textContent = 'رمز عبور مطابقت ندارد';
                return;
            }
            
            const result = await window.handleRegister({
                email: document.getElementById('reg-email').value,
                password: password,
                contactPerson: document.getElementById('reg-contact').value,
                phone: document.getElementById('reg-phone').value,
                company: document.getElementById('reg-company').value,
                position: document.getElementById('reg-position').value,
                userType: selectedUserType,
                sellerType: selectedUserType === 'seller' ? selectedSellerType : null,
                userLegalType: selectedUserLegalType
            });
            
            if (result.success) {
                alert('✅ ثبت‌نام موفق! به پنل کاربری هدایت میشوید.');
                if (selectedUserType === 'buyer') window.showPage('dashboard');
                else if (selectedUserType === 'seller' && selectedSellerType === 'formwork') window.showPage('seller-formwork-dashboard');
                else if (selectedUserType === 'seller' && selectedSellerType === 'shed') window.showPage('seller-shed-dashboard');
            } else {
                document.getElementById('register-error').textContent = result.error || 'خطا در ثبت‌نام';
            }
        });
        
        // فرم ورود
        document.getElementById('login-form')?.addEventListener('submit', async (e) => {
            e.preventDefault();
            const result = await window.handleLogin(
                document.getElementById('login-email').value,
                document.getElementById('login-password').value
            );
            
            if (result.success) {
                if (result.user.isAdmin) window.showPage('admin');
                else if (result.user.userType === 'buyer') window.showPage('dashboard');
                else if (result.user.userType === 'seller' && result.user.sellerType === 'formwork') window.showPage('seller-formwork-dashboard');
                else if (result.user.userType === 'seller' && result.user.sellerType === 'shed') window.showPage('seller-shed-dashboard');
                else window.showPage('home');
            } else {
                document.getElementById('login-error').textContent = 'ایمیل یا رمز عبور اشتباه است';
            }
        });
        
        // فرم سوله نو
        document.getElementById('new-shed-form')?.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!currentUser) {
                alert('❌ لطفاً ابتدا وارد حساب خود شوید.');
                window.showPage('login');
                return;
            }

            const { data: { user } } = await supabase.auth.getUser();
            if (!user) {
                alert('❌ خطا در احراز هویت');
                return;
            }

            const shedData = {
                user_id: user.id,
                dimensions: {
                    length: parseFloat(document.getElementById('shed-length')?.value || 0),
                    width: parseFloat(document.getElementById('shed-width')?.value || 0),
                    height: parseFloat(document.getElementById('shed-height')?.value || 0)
                },
                usage: document.getElementById('shed-usage')?.value || '',
                location: document.getElementById('shed-location')?.value || '',
                has_drawing: document.querySelector('input[name="has-drawing"]:checked')?.value === 'yes',
                needs_crane: document.querySelector('input[name="needs-crane"]:checked')?.value === 'yes',
                crane_tonnage: document.getElementById('crane-tonnage')?.value || null,
                foundation: document.querySelector('input[name="foundation"]:checked')?.value || 'no',
                sandblast: document.querySelector('input[name="sandblast"]:checked')?.value || 'no',
                paint_type: document.getElementById('paint-type')?.value || '',
                other_paint_type: document.getElementById('other-paint-type')?.value || '',
                paint_thickness: parseInt(document.getElementById('paint-thickness')?.value) || 50,
                buyer_responsibilities: Array.from(document.querySelectorAll('input[name="responsibility"]:checked')).map(cb => cb.value),
                weight: document.getElementById('shed-weight')?.value || null,
                price_type: document.querySelector('input[name="price-type"]:checked')?.value || 'estimated',
                status: 'open',
                created_at: new Date().toISOString()
            };

            if (!shedData.dimensions.length || !shedData.dimensions.width || !shedData.dimensions.height) {
                alert('❌ لطفاً ابعاد سوله را وارد کنید.');
                return;
            }

            if (!shedData.usage || !shedData.location) {
                alert('❌ لطفاً کارکرد و محل نصب را وارد کنید.');
                return;
            }

            try {
                const { error } = await supabase
                    .from('shed_requests')
                    .insert([shedData]);

                if (error) throw error;

                alert('✅ درخواست شما با موفقیت ثبت شد!');
                window.showPage('shed');
                e.target.reset();
                
            } catch (error) {
                console.error('❌ خطا:', error);
                alert('خطا در ثبت درخواست: ' + error.message);
            }
        });
        
        // مقداردهی اولیه
        window.updateNavigation();
        window.showPage('home');
        window.loadCounters();
        window.initImageSlider();
    });
</script>
</body>
</html>